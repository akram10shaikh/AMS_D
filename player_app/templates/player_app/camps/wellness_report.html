{% extends "player_app/organization/base.html" %}
{% load static %}

{% block title %}Wellness Report - {{ camp.name }}{% endblock %}

{% block extra_head %}
<style>
    .welcome-section { 
        height: 260px; 
        background: #007CF0; 
        display: flex; 
        align-items: center; 
        padding: 0 2rem; 
    }
    .main-card { 
        max-width: 1200px; 
        margin: -80px auto 2rem auto; 
        background: white; 
        border-radius: 16px; 
        padding: 2rem; 
        box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
    }
    
    .camp-header {
        color: black;
        padding: 2rem;
        border-radius: 16px;
        text-align: center;
        margin-bottom: 2rem;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }
    .stat-card {
        background: #f8fafc;
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        border: 1px solid #e2e8f0;
    }
    .stat-number { font-size: 2rem; font-weight: 800; color: #007CF0; }
    
    /* TABLE STYLES */
    .data-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        margin-bottom: 2rem;
    }
    .data-table th {
        background: #f8fafc;
        padding: 1rem 1.5rem;
        text-align: left;
        font-weight: 600;
        color: #1e293b;
        border-bottom: 2px solid #e2e8f0;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    .data-table td {
        padding: 1rem 1.5rem;
        border-bottom: 1px solid #f1f5f9;
        vertical-align: top;
    }
    .data-table tr:hover {
        background: #f8fafc;
    }
    .data-table tbody tr:nth-child(even) {
        background: #fafbfc;
    }
    
    .metric-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        background: #dcfce7;
        color: #166534;
    }
    .pain-alert {
        background: #fee2e2;
        border-left: 4px solid #ef4444;
        padding: 0.5rem 0.75rem !important;
        color: #dc2626;
        font-weight: 600;
    }
    .training-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.25rem;
    }
    .training-tag {
        background: #dcfce7;
        color: #166534;
        padding: 0.15rem 0.5rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
    }
    
    .back-btn {
        background: #0f172a;
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        margin-top: 1rem;
    }
    
    @media (max-width: 768px) {
        .data-table {
            font-size: 0.85rem;
        }
        .data-table th, .data-table td {
            padding: 0.75rem 0.5rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="welcome-section">
    <h1 style="color: white;">Daily Wellness Report</h1>
</div>

<main class="main-card">
    <!-- Camp Header -->
    <div class="camp-header">
        <h2 style="margin: 0; font-size: 2rem;">{{ camp.name }}</h2>
        <p style="margin: 0.5rem 0 0 0; opacity: 0.9;">
            {{ total_tests }} Wellness Test{{ total_tests|pluralize }} from {{ unique_players }} Player{{ unique_players|pluralize }}
        </p>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ total_tests }}</div>
            <div style="font-size: 0.9rem; color: #64748b;">Total Tests</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ unique_players }}</div>
            <div style="font-size: 0.9rem; color: #64748b;">Unique Players</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ wellness_tests|length }}</div>
            <div style="font-size: 0.9rem; color: #64748b;">In This Camp</div>
        </div>
    </div>

    <!-- DATA TABLE -->
    {% if wellness_tests %}
        <table class="data-table">
            <thead>
                <tr>
                    <th>Player</th>
                    <th>Date</th>
                    <th>Urine Color</th>
                    <th>Soreness</th>
                    <th>Fatigue</th>
                    <th>Sleep</th>
                    <th>Motivation</th>
                    <th>RPE</th>
                    <th>Balls</th>
                    <th>Training</th>
                    <th>Pain</th>
                </tr>
            </thead>
            <tbody>
                {% for test in wellness_tests %}
                    <tr>
                        <td>
                            <strong>{{ test.player.name }}</strong>
                            {% if test.created_by %}
                                <br><small style="color: #64748b;">{{ test.created_by.get_full_name|default:test.created_by.username }}</small>
                            {% endif %}
                        </td>
                        <td>
                            <span class="metric-badge">{{ test.date|date:"M d, Y" }}</span>
                        </td>
                        <td>{{ test.urine_color|title }}</td>
                        <td><span class="metric-badge">{{ test.soreness_level }}/10</span></td>
                        <td><span class="metric-badge">{{ test.fatigue_level }}/10</span></td>
                        <td>{{ test.sleep_hours }}h</td>
                        <td><span class="metric-badge">{{ test.motivation_level }}/10</span></td>
                        <td><span class="metric-badge">{{ test.total_rpe }}/10</span></td>
                        <td>{{ test.balls_bowled }}</td>
                        <td>
                            {% if test.training_session_types %}
                                <div class="training-tags">
                                    {% for session in test.training_session_types %}
                                        <span class="training-tag">{{ session }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                ‚Äî
                            {% endif %}
                        </td>
                        <td>
                            {% if test.has_pain %}
                                <span class="metric-badge pain-alert">
                                    ‚ö†Ô∏è {{ test.pain_comment|default:"Pain" }}
                                </span>
                            {% else %}
                                <span style="color: #10B981;">‚úì None</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div style="text-align: center; padding: 4rem 2rem; color: #64748b;">
            <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.3;">üìã</div>
            <h3>No Wellness Data</h3>
            <p>No players from <strong>"{{ camp.name }}"</strong> have completed daily wellness tests yet.</p>
        </div>
    {% endif %}

    <a href="{% url 'organization_camp_detail' camp_id %}" class="back-btn">‚Üê Back to Camps</a>
</main>
{% endblock %}
