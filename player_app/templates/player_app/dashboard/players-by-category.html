{% extends "player_app/organization/base.html" %}
{% load static %}

{% block title %}{{ category_display }} - Players{% endblock %}
{% block extra_head %}
<style>
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  
  @media (max-width: 768px) {
    .table-container { font-size: 14px; }
    table th, table td { padding: 10px 8px; }
  }
</style>
{% endblock %}

{% block content %}

<div class="page-header" style="margin-bottom: 30px;">
  <h1 style="font-size: 35px; margin-bottom: 10px;">{{ category_display }} Players</h1>
  <p style="font-size: 18px; color: #666; margin: 0;">
    Total Players: <strong>{{ total_players }}</strong> 
    {% if age_category %}in {{ category_display }}{% endif %}
  </p>
  <a href="{% url 'organization_dashboard_org' %}" class="btn-back" style="background: #36a9e1; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: 700; margin-top: 10px; display: inline-block;">
    ‚Üê Back to Dashboard
  </a>
</div>

<!-- Players Table -->
<section aria-labelledby="playersTableTitle">
  <h2 id="playersTableTitle" class="sr-only">Players List</h2>
  <div class="table-container" style="overflow-x: auto;margin-bottom:100px;">
    <table id="playersTable" role="grid" style="width: 100%; border-collapse: collapse; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border-radius: 10px; overflow: hidden;">
      <thead style="background: #36a9e1; color: white;">
        <tr>
          <th scope="col" style="padding: 15px 12px; text-align: left; font-weight: 700;">Player Name</th>
          <th scope="col" style="padding: 15px 12px; text-align: left; font-weight: 700;">Age Category</th>
          <th scope="col" style="padding: 15px 12px; text-align: left; font-weight: 700;">Gender</th>
          <th scope="col" style="padding: 15px 12px; text-align: left; font-weight: 700;">Participation Status</th>
          <th scope="col" style="padding: 15px 12px; text-align: left; font-weight: 700;">Injuries Title</th>
          <th scope="col" style="padding: 15px 12px; text-align: left; font-weight: 700;">Camps</th>
          <th scope="col" style="padding: 15px 12px; text-align: center; font-weight: 700;">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for player in players %}
        <tr>
          <td style="padding: 15px 12px; font-weight: 600; color: #333;">
            {{ player.name }}
          </td>
          <td style="padding: 15px 12px; color: #666;">
            {{ player.age_category|title }}
          </td>
          <td style="padding: 15px 12px; color: #666;">
            {{ player.gender }}
          </td>
          <td style="padding: 15px 12px;">
            {% if player.player_status == 'full participation' %}
              <span style="background: #36e156; color: white; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700;">Full</span>
            {% elif player.player_status == 'limited participation' %}
              <span style="background: #ffe346; color: #333; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700;">Limited</span>
            {% elif player.player_status == 'no participation' %}
              <span style="background: #ff3939; color: white; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700;">None</span>
            {% else %}
              <span style="color: #999;">N/A</span>
            {% endif %}
          </td>
         <td style="padding: 15px 12px;">
            {% with open_injuries=player.open_injuries %}
              {% if open_injuries %}
                {% for injury in open_injuries %}
                  <div style="margin-bottom: 2px;">
                    <a href="{% url 'organization_injury_detail' injury.id %}" 
                      style="background: linear-gradient(45deg, #ff3939, #ff6b6b); color: white; padding: 3px 7px; border-radius: 10px; font-size: 11px; font-weight: 700; text-decoration: none; display: inline-block; box-shadow: 0 1px 3px rgba(0,0,0,0.2);"
                      target="_blank">
                      #{{ injury.id }}
                    </a>
                  </div>
                {% endfor %}
              {% else %}
                <span style="background: #36e156; color: white; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700;">0</span>
              {% endif %}
            {% endwith %}
          </td>

          <td style="padding: 15px 12px;">
            {% if player.camps.all %}
              <ul style="margin: 0; padding-left: 20px; font-size: 14px;">
                {% for camp in player.camps.all|slice:":3" %}
                  <li style="color: #666;">{{ camp.name }}</li>
                {% endfor %}
                {% if player.camps.all|length > 3 %}
                  <li style="color: #999; font-style: italic;">+{{ player.camps.all|length|add:"-3" }} more</li>
                {% endif %}
              </ul>
            {% else %}
              <span style="color: #999; font-style: italic;">No camps</span>
            {% endif %}
          </td>
          <td style="padding: 15px 12px; text-align: center;">
            <a href="{% url 'organization_player_detail' player.id %}" 
               style="background: #36a9e1; color: white; padding: 8px 12px; text-decoration: none; border-radius: 5px; font-size: 14px; font-weight: 600;"
               target="_blank">View</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" style="padding: 40px; text-align: center; color: #999; font-style: italic;">
            No players found for this category.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>



{% endblock %}
